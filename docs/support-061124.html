<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Débuter avec R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Débuter avec R</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><i class="fa-solid fa-house-user" aria-label="house-user"></i> Accueil</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metadata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Métadonnées</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><i class="fa-solid fa-person-chalkboard" aria-label="person-chalkboard"></i> Support de formation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./support-061124.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Débuter avec R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphiques produits</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><i class="fa-solid fa-toolbox" aria-label="toolbox"></i> Matériel</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dico_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dictionnaire des codes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./article.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Article Population et Société</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://gitlab.com/mthevenin/website_lifeobs2/-/blob/master/materiel/TEO1_v4.RData?ref_type=heads" class="sidebar-item-text sidebar-link">
 <span class="menu-text">La base de données</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><i class="fa-solid fa-book" aria-label="book"></i> Références</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./biblio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#présentation-de-r-et-rstudio" id="toc-présentation-de-r-et-rstudio" class="nav-link active" data-scroll-target="#présentation-de-r-et-rstudio">Présentation de R et Rstudio</a></li>
  <li><a href="#interface-de-base-r" id="toc-interface-de-base-r" class="nav-link" data-scroll-target="#interface-de-base-r">Interface de base R</a></li>
  <li><a href="#interface-r-studio" id="toc-interface-r-studio" class="nav-link" data-scroll-target="#interface-r-studio">Interface R Studio</a></li>
  <li><a href="#syntaxe-r" id="toc-syntaxe-r" class="nav-link" data-scroll-target="#syntaxe-r">Syntaxe R</a></li>
  <li><a href="#syntaxe-r-1" id="toc-syntaxe-r-1" class="nav-link" data-scroll-target="#syntaxe-r-1">Syntaxe R</a></li>
  <li><a href="#créer-son-répertoire-de-travail" id="toc-créer-son-répertoire-de-travail" class="nav-link" data-scroll-target="#créer-son-répertoire-de-travail">Créer son répertoire de travail</a></li>
  <li><a href="#installer-et-activer-des-packages" id="toc-installer-et-activer-des-packages" class="nav-link" data-scroll-target="#installer-et-activer-des-packages">Installer et activer des packages</a></li>
  <li><a href="#importer-des-données" id="toc-importer-des-données" class="nav-link" data-scroll-target="#importer-des-données">Importer des données</a></li>
  <li><a href="#importer-des-données-1" id="toc-importer-des-données-1" class="nav-link" data-scroll-target="#importer-des-données-1">Importer des données</a></li>
  <li><a href="#décrire-ses-données" id="toc-décrire-ses-données" class="nav-link" data-scroll-target="#décrire-ses-données">Décrire ses données</a></li>
  <li><a href="#contenu-dune-table-et-type-des-variables" id="toc-contenu-dune-table-et-type-des-variables" class="nav-link" data-scroll-target="#contenu-dune-table-et-type-des-variables">Contenu d’une table et type des variables</a></li>
  <li><a href="#dataexplorer" id="toc-dataexplorer" class="nav-link" data-scroll-target="#dataexplorer">DataExplorer</a></li>
  <li><a href="#voir-les-valeurs-manquantes" id="toc-voir-les-valeurs-manquantes" class="nav-link" data-scroll-target="#voir-les-valeurs-manquantes">Voir les valeurs manquantes</a></li>
  <li><a href="#tris-à-plat-distribution-des-valeurs" id="toc-tris-à-plat-distribution-des-valeurs" class="nav-link" data-scroll-target="#tris-à-plat-distribution-des-valeurs">Tris à plat: distribution des valeurs</a></li>
  <li><a href="#tris-à-plat-distribution-des-valeurs-1" id="toc-tris-à-plat-distribution-des-valeurs-1" class="nav-link" data-scroll-target="#tris-à-plat-distribution-des-valeurs-1">Tris à plat: distribution des valeurs</a></li>
  <li><a href="#tris-croisés" id="toc-tris-croisés" class="nav-link" data-scroll-target="#tris-croisés">Tris croisés</a></li>
  <li><a href="#résumer-une-variable-numérique" id="toc-résumer-une-variable-numérique" class="nav-link" data-scroll-target="#résumer-une-variable-numérique">Résumer une variable numérique</a></li>
  <li><a href="#calcul-dune-variable-numérique" id="toc-calcul-dune-variable-numérique" class="nav-link" data-scroll-target="#calcul-dune-variable-numérique">Calcul d’une variable numérique</a></li>
  <li><a href="#graphiques" id="toc-graphiques" class="nav-link" data-scroll-target="#graphiques">Graphiques</a></li>
  <li><a href="#boite-à-moustaches" id="toc-boite-à-moustaches" class="nav-link" data-scroll-target="#boite-à-moustaches">Boite à moustaches</a></li>
  <li><a href="#boite-à-moustaches-1" id="toc-boite-à-moustaches-1" class="nav-link" data-scroll-target="#boite-à-moustaches-1">Boite à moustaches</a></li>
  <li><a href="#nuage-de-point" id="toc-nuage-de-point" class="nav-link" data-scroll-target="#nuage-de-point">Nuage de point</a></li>
  <li><a href="#nuage-de-point-1" id="toc-nuage-de-point-1" class="nav-link" data-scroll-target="#nuage-de-point-1">Nuage de point</a></li>
  <li><a href="#diagramme-en-baton" id="toc-diagramme-en-baton" class="nav-link" data-scroll-target="#diagramme-en-baton">Diagramme en baton</a></li>
  <li><a href="#diagramme-de-cleveland" id="toc-diagramme-de-cleveland" class="nav-link" data-scroll-target="#diagramme-de-cleveland">Diagramme de Cleveland</a></li>
  <li><a href="#esquisse-faire-des-graphiques-sans-coder" id="toc-esquisse-faire-des-graphiques-sans-coder" class="nav-link" data-scroll-target="#esquisse-faire-des-graphiques-sans-coder">Esquisse: faire des graphiques sans coder</a></li>
  <li><a href="#esquisse" id="toc-esquisse" class="nav-link" data-scroll-target="#esquisse">Esquisse</a></li>
  <li><a href="#manipulation-des-données-avec-r-de-base" id="toc-manipulation-des-données-avec-r-de-base" class="nav-link" data-scroll-target="#manipulation-des-données-avec-r-de-base">Manipulation des données avec R de base</a></li>
  <li><a href="#selection-de-variables-et-dobservation" id="toc-selection-de-variables-et-dobservation" class="nav-link" data-scroll-target="#selection-de-variables-et-dobservation">Selection de variables et d’observation</a></li>
  <li><a href="#selection-de-variables-ou-colonnes" id="toc-selection-de-variables-ou-colonnes" class="nav-link" data-scroll-target="#selection-de-variables-ou-colonnes">Selection de variables (ou colonnes)</a></li>
  <li><a href="#selection-dobservations-ou-de-lignes" id="toc-selection-dobservations-ou-de-lignes" class="nav-link" data-scroll-target="#selection-dobservations-ou-de-lignes">Selection d’observations (ou de lignes)</a></li>
  <li><a href="#convertir-des-données" id="toc-convertir-des-données" class="nav-link" data-scroll-target="#convertir-des-données">Convertir des données</a></li>
  <li><a href="#recodage-et-création-de-variables" id="toc-recodage-et-création-de-variables" class="nav-link" data-scroll-target="#recodage-et-création-de-variables">Recodage et création de variables</a></li>
  <li><a href="#recodage-et-création-de-variables-1" id="toc-recodage-et-création-de-variables-1" class="nav-link" data-scroll-target="#recodage-et-création-de-variables-1">Recodage et création de variables</a></li>
  <li><a href="#organiser-et-traiter-plus-facilement-ses-données-avec-le-package-dplyr" id="toc-organiser-et-traiter-plus-facilement-ses-données-avec-le-package-dplyr" class="nav-link" data-scroll-target="#organiser-et-traiter-plus-facilement-ses-données-avec-le-package-dplyr">Organiser et traiter plus facilement ses données avec le package dplyr</a></li>
  <li><a href="#package-dplyr" id="toc-package-dplyr" class="nav-link" data-scroll-target="#package-dplyr">Package dplyr</a></li>
  <li><a href="#les-5-verbes-ou-fonction-de-base-de-dplyr" id="toc-les-5-verbes-ou-fonction-de-base-de-dplyr" class="nav-link" data-scroll-target="#les-5-verbes-ou-fonction-de-base-de-dplyr">Les 5 verbes (ou fonction) de base de dplyr</a></li>
  <li><a href="#select-sélection-de-variables" id="toc-select-sélection-de-variables" class="nav-link" data-scroll-target="#select-sélection-de-variables">Select: Sélection de variables</a></li>
  <li><a href="#filter-sélection-dobservations" id="toc-filter-sélection-dobservations" class="nav-link" data-scroll-target="#filter-sélection-dobservations">Filter: Sélection d’observations</a></li>
  <li><a href="#arrange-trier-les-observations" id="toc-arrange-trier-les-observations" class="nav-link" data-scroll-target="#arrange-trier-les-observations">Arrange: Trier les observations</a></li>
  <li><a href="#mutate-création-de-variables" id="toc-mutate-création-de-variables" class="nav-link" data-scroll-target="#mutate-création-de-variables">Mutate: Création de variables</a></li>
  <li><a href="#chainage-des-opérations-avec-le-pipe" id="toc-chainage-des-opérations-avec-le-pipe" class="nav-link" data-scroll-target="#chainage-des-opérations-avec-le-pipe">Chainage des opérations avec le “pipe” %&gt;%</a></li>
  <li><a href="#la-fonction-group_by" id="toc-la-fonction-group_by" class="nav-link" data-scroll-target="#la-fonction-group_by">La fonction group_by</a></li>
  <li><a href="#la-fonction-summarise" id="toc-la-fonction-summarise" class="nav-link" data-scroll-target="#la-fonction-summarise">La fonction summarise</a></li>
  <li><a href="#la-fonction-summarise-1" id="toc-la-fonction-summarise-1" class="nav-link" data-scroll-target="#la-fonction-summarise-1">La fonction summarise</a></li>
  <li><a href="#calculer-un-rang" id="toc-calculer-un-rang" class="nav-link" data-scroll-target="#calculer-un-rang">Calculer un rang</a></li>
  <li><a href="#reproduire-les-résultats-du-popsoc" id="toc-reproduire-les-résultats-du-popsoc" class="nav-link" data-scroll-target="#reproduire-les-résultats-du-popsoc">Reproduire les résultats du Pop&amp;soc</a></li>
  <li><a href="#reproduire-les-résultats-du-popsoc-1" id="toc-reproduire-les-résultats-du-popsoc-1" class="nav-link" data-scroll-target="#reproduire-les-résultats-du-popsoc-1">Reproduire les résultats du Pop&amp;soc</a></li>
  <li><a href="#les-jointures-et-empilements" id="toc-les-jointures-et-empilements" class="nav-link" data-scroll-target="#les-jointures-et-empilements">Les jointures et empilements</a></li>
  <li><a href="#les-jointures" id="toc-les-jointures" class="nav-link" data-scroll-target="#les-jointures">Les jointures</a></li>
  <li><a href="#les-jointures-1" id="toc-les-jointures-1" class="nav-link" data-scroll-target="#les-jointures-1">Les jointures</a></li>
  <li><a href="#les-jointures-2" id="toc-les-jointures-2" class="nav-link" data-scroll-target="#les-jointures-2">Les jointures</a></li>
  <li><a href="#les-empilements" id="toc-les-empilements" class="nav-link" data-scroll-target="#les-empilements">Les empilements</a></li>
  <li><a href="#limites-des-jointures" id="toc-limites-des-jointures" class="nav-link" data-scroll-target="#limites-des-jointures">Limites des jointures</a></li>
  <li><a href="#transformation-des-données" id="toc-transformation-des-données" class="nav-link" data-scroll-target="#transformation-des-données">Transformation des données</a></li>
  <li><a href="#pivot_wider-de-long-en-large" id="toc-pivot_wider-de-long-en-large" class="nav-link" data-scroll-target="#pivot_wider-de-long-en-large">Pivot_wider : de long en large</a></li>
  <li><a href="#pivot_longer-de-large-en-long" id="toc-pivot_longer-de-large-en-long" class="nav-link" data-scroll-target="#pivot_longer-de-large-en-long">Pivot_longer : de large en long</a></li>
  <li><a href="#traitements-massifs-et-opérations-sur-les-métadonnées" id="toc-traitements-massifs-et-opérations-sur-les-métadonnées" class="nav-link" data-scroll-target="#traitements-massifs-et-opérations-sur-les-métadonnées">Traitements massifs et opérations sur les métadonnées</a></li>
  <li><a href="#traitements-massifs-et-opérations-sur-les-métadonnées-1" id="toc-traitements-massifs-et-opérations-sur-les-métadonnées-1" class="nav-link" data-scroll-target="#traitements-massifs-et-opérations-sur-les-métadonnées-1">Traitements massifs et opérations sur les métadonnées</a></li>
  <li><a href="#sauvegarder-son-travail-et-recharger-ses-données" id="toc-sauvegarder-son-travail-et-recharger-ses-données" class="nav-link" data-scroll-target="#sauvegarder-son-travail-et-recharger-ses-données">Sauvegarder son travail et recharger ses données</a></li>
  <li><a href="#exporter-dans-un-fichier-excel" id="toc-exporter-dans-un-fichier-excel" class="nav-link" data-scroll-target="#exporter-dans-un-fichier-excel">Exporter dans un fichier excel</a></li>
  <li><a href="#références" id="toc-références" class="nav-link" data-scroll-target="#références">Références</a></li>
  <li><a href="#références-1" id="toc-références-1" class="nav-link" data-scroll-target="#références-1">Références</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Débuter avec R</h1>
<p class="subtitle lead">Support de formation</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">16 mai 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="présentation-de-r-et-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="présentation-de-r-et-rstudio">Présentation de R et Rstudio</h2>
<p>Logiciel R créé dans les années 1990 par Robert Gentleman &amp; Ross Ihaka. Développé depuis 1997 par la “R-core team”</p>
<ul>
<li><p>Dernière Version 4</p></li>
<li><p>Logiciel libre et gratuit permettant de faire des traitements de données statistiques</p></li>
<li><p>Ouvert : tout utilisateur peut ajouter ses fonctions personnelles</p></li>
<li><p>Transparent : l’utilisateur a accès au code source des fonctions</p></li>
<li><p>Multiplateforme : Windows, Linux, Mac</p></li>
<li><p>En constante évolution</p></li>
</ul>
</section>
<section id="interface-de-base-r" class="level2">
<h2 class="anchored" data-anchor-id="interface-de-base-r">Interface de base R</h2>
<p><a href="images/im_R.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/im_R.png" class="img-fluid"></a></p>
<p>Interface R de base pour coder. On peut l’utiliser comme calculatrice.</p>
<p><strong>Installation</strong> obligatoire (<a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a>) avant de pouvoir installer l’interface Rstudio (<a href="https://rstudio.com/products/rstudio/download/" class="uri">https://rstudio.com/products/rstudio/download/</a>), plus conviviale que nous allons utiliser.</p>
</section>
<section id="interface-r-studio" class="level2">
<h2 class="anchored" data-anchor-id="interface-r-studio">Interface R Studio</h2>
<p><a href="images/im_Rstudio.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/im_Rstudio.png" class="img-fluid"></a></p>
</section>
<section id="syntaxe-r" class="level2">
<h2 class="anchored" data-anchor-id="syntaxe-r">Syntaxe R</h2>
<ul>
<li>R est sensible à la casse<br>
</li>
<li>Ctrl entrée (Windows) ou Cmd entrée (Mac) pour soumettre le code ou bouton Run<br>
</li>
<li>Commentaire: #commentaires<br>
</li>
<li>Pour les chemins il faut inverser les antislash par des slash: “D:/R/Formation_R”<br>
</li>
<li>Les valeurs manquantes: NA, is.na<br>
</li>
<li>Opérateurs permis : ==, &lt;, &gt;, !=, %in%<br>
</li>
<li>Opérateurs logiques : &amp;, |, !<br>
</li>
</ul>
</section>
<section id="syntaxe-r-1" class="level2">
<h2 class="anchored" data-anchor-id="syntaxe-r-1">Syntaxe R</h2>
<ul>
<li>F1 sur une fonction R afin d’être dirigé directement vers l’aide ou soumettre ?nomdelafonction</li>
<li>script R : où vous écrivez votre code, enregistré sous .R (s’ouvre avec n’importe quel éditeur de texte)</li>
<li>Rmarkdown ou Quarto: pour mettre en forme des documents contenant à la fois du texte, des instructions R et le résultat fourni par R.</li>
</ul>
</section>
<section id="créer-son-répertoire-de-travail" class="level2">
<h2 class="anchored" data-anchor-id="créer-son-répertoire-de-travail">Créer son répertoire de travail</h2>
<ul>
<li><p>On peut dire au logiciel où se trouve nos fichiers<br>
<code>setwd("D:/formation/R")</code></p></li>
<li><p>Il est conseillé de créer un nouveau projet (File: New project) lorsque vous commencez un nouveau traitement, tous vos objets R seront sauvegardés (programmes, images, sorties) au même endroit.</p></li>
<li><p>La commande getwd indique le répertoire sur lequel vous travaillez: <code>getwd()</code></p></li>
<li><p>Informer en début ou fin de programme quelles versions de R et de packages on utilise: <code>sessionInfo()</code></p></li>
</ul>
</section>
<section id="installer-et-activer-des-packages" class="level2">
<h2 class="anchored" data-anchor-id="installer-et-activer-des-packages">Installer et activer des packages</h2>
<p>En clic bouton: cliquer dans la fenêtre en bas à droite de R Studio sur l’onglet Packages, cliquer sur Install et écrire le nom du package</p>
<p>En code :<br>
<code>install.packages("questionr")</code><br>
Ne pas oublier les guillemets entre le nom du package.</p>
<p>Attention ne pas oublier qu’à chaque fois que vous ouvrez R, et après avoir installer les packages, il faut les charger avec la commande <code>library</code><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ou cocher les packages en bas à droite de votre Rstudio dans l’onglet “Packages”</p>
</section>
<section id="importer-des-données" class="level2">
<h2 class="anchored" data-anchor-id="importer-des-données">Importer des données</h2>
<p>Vous pouvez importer en clic bouton un fichier texte, excel, SPSS, SAS ou Stata (menu File: Import Dataset).</p>
<p>Importer un fichier Excel: cliquer sur le bouton browse et selectionner son fichier: <img src="images/import_excel.png" class="img-fluid"></p>
</section>
<section id="importer-des-données-1" class="level2">
<h2 class="anchored" data-anchor-id="importer-des-données-1">Importer des données</h2>
<p>Recupérer le code avec un copier-coller:<br>
<code>library(readxl)</code><br>
<code>idf &lt;- read_excel("idf.xlsx")</code></p>
<p>Importer un fichier texte: En clic bouton: File : Import Dataset : From Text(base)<br>
En code:&nbsp;<code>temperature &lt;-read.table("temperature.txt",header=TRUE, sep="\t", na.strings="NA", dec=",")</code> header : intitules des variables sep : séparateur de colonnes dec : séparateur de décimal</p>
<p>Ou un fichier CSV:<br>
<code>smp&lt;- read.csv2("smp1.csv")</code></p>
</section>
<section id="décrire-ses-données" class="level2">
<h2 class="anchored" data-anchor-id="décrire-ses-données">Décrire ses données</h2>
<p>Nous allons utiliser le fichier d’exemple TEO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"./materiel/TEO1_v4.RData"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour copier la table sous un autre nom par exemple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>FPA <span class="ot">&lt;-</span> teo</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le tableau individus x variables sont des data.frame dans R</p>
<p>Tapez le nom du tableau de données puis entrée : affiche le tableau de données ou cliquer dans l’interface graphique sur l’icone tableau à droite:</p>
<p><a href="images/env_teo.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/env_teo.PNG" class="img-fluid"></a></p>
</section>
<section id="contenu-dune-table-et-type-des-variables" class="level2">
<h2 class="anchored" data-anchor-id="contenu-dune-table-et-type-des-variables">Contenu d’une table et type des variables</h2>
<p>Plusieurs types de variables : “numeric”, “integer”, “character” ou “factor”</p>
<p>Description de toutes les variables selon leur type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FPA)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID            POIDSI         SEXEE       SEXEE_clair   
 Min.   : 1000   Min.   :   13.19   1:10281   Masculin:10281  
 1st Qu.:10973   1st Qu.:  255.86   2:11480   Féminin :11480  
 Median :20723   Median :  394.96                             
 Mean   :20630   Mean   : 1594.55                             
 3rd Qu.:30390   3rd Qu.:  674.58                             
 Max.   :40000   Max.   :59700.82                             
                                                              
 age_tranches           taille          poids          poids_rec     S_ETAT  
 Length:21761       Min.   :145.3   Min.   : 47.81   Min.   :47.81   1:8656  
 Class :character   1st Qu.:161.7   1st Qu.: 62.01   1st Qu.:62.01   2:9453  
 Mode  :character   Median :167.6   Median : 67.59   Median :67.59   3:2995  
                    Mean   :168.1   Mean   : 69.96   Mean   :68.90   4: 523  
                    3rd Qu.:174.7   3rd Qu.: 75.90   3rd Qu.:75.90   5: 113  
                    Max.   :189.7   Max.   :999.00   Max.   :93.47   9:  21  
                                                                             
       S_ETAT_clair      F_DIP           F_DIP_clair   SITUAE   
 Très Bon    :8656   4      :4369   CAP_BEP    :4369   1:14387  
 Bon         :9453   8      :3846   Sup_Bac+2  :3846   2:  197  
 Moyen       :2995   1      :3559   Aucun      :3559   3: 2335  
 Mauvais     : 523   7      :2335   Bac+2      :2335   4: 2284  
 Très Mauvais: 113   6      :2273   Bac_général:2273   5:  319  
 NSP         :  21   (Other):4998   (Other)    :4998   6: 1709  
                     NA's   : 381   NA's       : 381   7:  530  
        SITUAE_clair   P_NSTPTC     P_SATPTC       cs_act_6T   
 Emploi       :14387   1   : 1159   1   :11073   5      :4842  
 Apprentissage:  197   2   :  119   2   : 2202   6      :3707  
 Etudes       : 2335   NA's:20483   NA's: 8486   4      :3332  
 Chômage      : 2284                             3      :2130  
 Retraite     :  319                             2      : 874  
 AuFoyer      : 1709                             (Other):  95  
 Autre        :  530                             NA's   :6781  
       cs_act_6T_clair GROUP1                 GROUP1_clair  INATUE   
 Employés      :4842   1:8456   Immigré             :8456   1:16852  
 Ouvriers      :3707   2: 712   Natif DOM           : 712   2: 1542  
 ProfInter     :3332   3:8161   Descendant Immigré-s:8161   3: 3367  
 Cadres        :2130   4: 651   Descendant DOM      : 651            
 Arti_Comm_Chef: 874   5:3781   Autres résid. Fr.   :3781            
 (Other)       :  95                                                 
 NA's          :6781                                                 
              INATUE_clair   regionnaise2_11t    L_AUJC     
 Française          :16852   Length:21761       1   : 3124  
 UE                 : 1542   Class :character   2   : 1872  
 Etrangère (hors UE): 3367   Mode  :character   3   :  742  
                                                4   :   37  
                                                9   :    1  
                                                NA's:15985  
                                                            
      L_AUJC_clair    L_AUJE           L_AUJE_clair    L_AUJL     
 Très Bien  : 3124   1   : 2043   Très Bien  : 2043   1   : 2674  
 Bien       : 1872   2   : 1367   Bien       : 1367   2   : 1577  
 Un peu     :  742   3   : 1609   Un peu     : 1609   3   : 1099  
 Pas du tout:   37   4   :  757   Pas du tout:  757   4   :  426  
 NSP        :    1   NA's:15985   NA's       :15985   NA's:15985  
 NA's       :15985                                                
                                                                  
      L_AUJL_clair    L_AUJP           L_AUJP_clair    FRAUJ      
 Très Bien  : 2674   1   : 2908   Très Bien  : 2908   0   :   28  
 Bien       : 1577   2   : 1963   Bien       : 1963   1   : 2992  
 Un peu     : 1099   3   :  851   Un peu     :  851   2   :  801  
 Pas du tout:  426   4   :   54   Pas du tout:   54   3   : 1955  
 NA's       :15985   NA's:15985   NA's       :15985   NA's:15985  
                                                                  
                                                                  
                     FRAUJ_clair    A_PERMIS  D_DISCRI  D_DISCRI_clair 
 Pas du tout               :   28   1:16086   1: 1028   Souvent: 1028  
 Autres cas                : 2992   2: 5675   2: 3849   Parfois: 3849  
 Très bien parlé et compris:  801             3:16784   Jamais :16784  
 Que des très bien         : 1955             8:    7   Refus  :    7  
 NA's                      :15985             9:   93   NSP    :   93  
                                                                       
                                                                       
 D_PQDISC_A D_PQDISC_B D_PQDISC_C D_PQDISC_D D_PQDISC_E D_PQDISC_F D_PQDISC_G
 0:21323    0:21339    0:21608    0:19859    0:18969    0:21334    0:21342   
 1:  438    1:  422    1:  153    1: 1902    1: 2792    1:  427    1:  419   
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
 D_PQDISC_H D_PQDISC_I D_PQDISC_J D_PQDISC_K D_PQDISC_L D_PQDISC_FLAG P_DRECH  
 0:21600    0:21725    0:21372    0:21450    0:21277    -1:   67      1: 2307  
 1:  161    1:   36    1:  389    1:  311    1:  484    -2:    1      2:19235  
                                                         0:16884      9:  219  
                                                         1: 4809               
                                                                               
                                                                               
                                                                               
 P_DISPQ_A P_DISPQ_B P_DISPQ_C P_DISPQ_D P_DISPQ_E P_DISPQ_F P_DISPQ_G
 0:21502   0:21586   0:21203   0:20587   0:21646   0:21363   0:20178  
 1:  259   1:  175   1:  558   1: 1174   1:  115   1:  398   1: 1583  
                                                                      
                                                                      
                                                                      
                                                                      
                                                                      
 P_DISPQ_FLAG T_VIOLEN  demarches       T_DIPLOM     T_DIPLOM_clair 
 -1:  259     1:  784   1   :  401   1      :10784   Aucun  :10784  
 -2:    4     2:20930   2   : 4476   2      : 2640   CEP    : 2640  
  0:17998     9:   47   NA's:16884   4      : 1836   CAP_BEP: 1836  
  1: 3500                            99     : 1507   NSP    : 1507  
                                     3      : 1324   Brevet : 1324  
                                     (Other): 3661   (Other): 3661  
                                     NA's   :    9   NA's   :    9  
    T_DIPLOP      T_DIPLOP_clair   cs_mere_6T         cs_mere_6T_clair
 1      :9172   Aucun    :9172   5      :6388   Employés      :6388   
 4      :2604   CAP_BEP  :2604   6      :2583   Ouvriers      :2583   
 99     :2416   NSP      :2416   4      :1969   ProfInter     :1969   
 2      :2372   CEP      :2372   2      :1251   Arti_Comm_Chef:1251   
 8      :2195   Sup_Bac+2:2195   1      : 729   Agriculteurs  : 729   
 (Other):2905   (Other)  :2905   (Other): 909   (Other)       : 909   
 NA's   :  97   NA's     :  97   NA's   :7932   NA's          :7932   
   cs_pere_6T          cs_pere_6T_clair regionnaism2_11t   regionnaisp2_11t  
 6      :10155   Ouvriers      :10155   Length:21761       Length:21761      
 2      : 2873   Arti_Comm_Chef: 2873   Class :character   Class :character  
 4      : 2376   ProfInter     : 2376   Mode  :character   Mode  :character  
 5      : 2188   Employés      : 2188                                        
 3      : 2029   Cadres        : 2029                                        
 (Other): 1928   (Other)       : 1928                                        
 NA's   :  212   NA's          :  212                                        
 TYPM5_MEN           TYPM5_MEN_clair  MATRIE         MATRIE_clair   GROUP1CA   
 1: 2857   Personne seule    : 2857   1: 9757   Celibataire: 9757   1   :5305  
 2: 2310   Fam.Monoparentale : 2310   2:10471   Marié.e    :10471   2   : 335  
 3: 2997   Couple sans enfant: 2997   3:  249   Veuf.ve    :  249   3   :1822  
 4:12348   Couple avec enfant:12348   4: 1284   Divorcé.e  : 1284   4   : 131  
 5: 1249   Autre type        : 1249                                 5   :8179  
                                                                    9   :   3  
                                                                    NA's:5986  
              GROUP1CA_clair    ap_renc         ap_m_civ       ap_m_relig   
 Immigré             :5305   Min.   :1955    Min.   :1960    Min.   :1962   
 Natif DOM           : 335   1st Qu.:1981    1st Qu.:1984    1st Qu.:1989   
 Descendant Immigré-s:1822   Median :1990    Median :1994    Median :1998   
 Descendant DOM      : 131   Mean   :1989    Mean   :1992    Mean   :1995   
 Autres résid. Fr.   :8179   3rd Qu.:1998    3rd Qu.:2001    3rd Qu.:2003   
 NSP                 :   3   Max.   :2010    Max.   :2010    Max.   :2010   
 NA's                :5986   NA's   :10644   NA's   :10893   NA's   :20024  
 C_RCTLIC_A C_RCTLIC_B C_RCTLIC_C C_RCTLIC_D C_RCTLIC_E C_RCTLIC_F C_RCTLIC_G
 0:19215    0:19128    0:19288    0:20319    0:21123    0:20619    0:20716   
 1: 2546    1: 2633    1: 2473    1: 1442    1:  638    1: 1142    1: 1045   
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
 C_RCTLIC_H C_RCTLIC_I C_RCTLIC_J C_RCTLIC_K C_RCTLIC_L C_RCTLIC_M C_RCTLIC_N
 0:21337    0:21409    0:21565    0:21592    0:21530    0:21584    0:21736   
 1:  424    1:  352    1:  196    1:  169    1:  231    1:  177    1:   25   
                                                                             
                                                                             
                                                                             
                                                                             
                                                                             
 C_RCTLIC_O C_RCTLIC_FLAG     nbunions_t    ma_force    
 0:21378    -1:   68      0        : 5451   1   : 1234  
 1:  383     0: 8088      plus de 1:16310   2   :  518  
             1:13605                        3   :  325  
                                            8   :    1  
                                            9   :   40  
                                            NA's:19643  
                                                        
              ma_force_clair     ma_init                    ma_init_clair  
 Oui à ce moment     : 1234   3      : 8259   Ensemble             : 8259  
 Oui mais plus tard  :  518   2      : 1160   Votre conjoint.e     : 1160  
 Non pression famille:  325   1      :  897   Vous-même            :  897  
 Refus               :    1   4      :  875   Parents/Beaux-parents:  875  
 NSP                 :   40   5      :   51   Autre pers. famille  :   51  
 NA's                :19643   (Other):   56   (Other)              :   56  
                              NA's   :10463   NA's                 :10463  </code></pre>
</div>
</div>
<p>Description de la variable sexe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FPA<span class="sc">$</span>SEXEE)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2 
10281 11480 </code></pre>
</div>
</div>
<p>Attention on doit toujours mettre <em>nom de la table</em><strong>$</strong><em>nom de la variable</em>, et pas le nom de la variable seule.</p>
</section>
<section id="dataexplorer" class="level2">
<h2 class="anchored" data-anchor-id="dataexplorer">DataExplorer</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>valeurs_manquantes<span class="ot">&lt;-</span><span class="fu">is.na</span>(FPA<span class="sc">$</span>F_DIP)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(FPA)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="support-061124_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="voir-les-valeurs-manquantes" class="level2">
<h2 class="anchored" data-anchor-id="voir-les-valeurs-manquantes">Voir les valeurs manquantes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(FPA)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="support-061124_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tris-à-plat-distribution-des-valeurs" class="level2">
<h2 class="anchored" data-anchor-id="tris-à-plat-distribution-des-valeurs">Tris à plat: distribution des valeurs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(FPA<span class="sc">$</span>regionnaisp2_11t)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                 9999 Afrique subsaharienne               Algérie 
                   53                  2188                  2343 
                 Asie           Autres pays                   DOM 
                 1246                  1780                  1180 
       Espagne/Italie          France métro         Maroc/Tunisie 
                 1783                  4665                  2376 
             Portugal               Turquie                  UE27 
                 1688                  1283                  1079 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des valeurs manquantes</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(FPA<span class="sc">$</span>regionnaisp2_11t, <span class="at">useNA =</span> <span class="st">"ifany"</span>) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                 9999 Afrique subsaharienne               Algérie 
                   53                  2188                  2343 
                 Asie           Autres pays                   DOM 
                 1246                  1780                  1180 
       Espagne/Italie          France métro         Maroc/Tunisie 
                 1783                  4665                  2376 
             Portugal               Turquie                  UE27 
                 1688                  1283                  1079 
                 &lt;NA&gt; 
                   97 </code></pre>
</div>
</div>
</section>
<section id="tris-à-plat-distribution-des-valeurs-1" class="level2">
<h2 class="anchored" data-anchor-id="tris-à-plat-distribution-des-valeurs-1">Tris à plat: distribution des valeurs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># avec des pourcentages (package questionr)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(FPA<span class="sc">$</span>regionnaisp2_11t)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         n    % val%
9999                    53  0.2  0.2
Afrique subsaharienne 2188 10.1 10.1
Algérie               2343 10.8 10.8
Asie                  1246  5.7  5.8
Autres pays           1780  8.2  8.2
DOM                   1180  5.4  5.4
Espagne/Italie        1783  8.2  8.2
France métro          4665 21.4 21.5
Maroc/Tunisie         2376 10.9 11.0
Portugal              1688  7.8  7.8
Turquie               1283  5.9  5.9
UE27                  1079  5.0  5.0
NA                      97  0.4   NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tris à plat avec pondération </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">wtd.table</span>(FPA<span class="sc">$</span>regionnaisp2_11t, <span class="at">weights=</span>FPA<span class="sc">$</span>POIDSI,<span class="at">normwt=</span>T)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(result)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 9999 Afrique subsaharienne               Algérie 
            0.2563999             1.5133015             5.2188465 
                 Asie           Autres pays                   DOM 
            0.5587221             3.0115168             1.2953399 
       Espagne/Italie          France métro         Maroc/Tunisie 
            2.9744202            75.6531928             4.2796721 
             Portugal               Turquie                  UE27 
            2.3169533             0.8576965             2.0639385 </code></pre>
</div>
</div>
</section>
<section id="tris-croisés" class="level2">
<h2 class="anchored" data-anchor-id="tris-croisés">Tris croisés</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(FPA<span class="sc">$</span>D_DISCRI, FPA<span class="sc">$</span>SEXEE) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       1    2
  1  557  471
  2 1931 1918
  3 7740 9044
  8    5    2
  9   48   45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># avec pondération </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tw3<span class="ot">=</span><span class="fu">wtd.table</span>(FPA<span class="sc">$</span>D_DISCRI,FPA<span class="sc">$</span>SEXEE,<span class="at">weights=</span>FPA<span class="sc">$</span>POIDSI)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cprop</span>(tw3)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1     2     Ensemble
1       2.4   2.1   2.2   
2       9.2  10.8  10.0   
3      88.3  86.8  87.6   
8       0.0   0.0   0.0   
9       0.1   0.3   0.2   
Total 100.0 100.0 100.0   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lprop</span>(tw3)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1     2     Total
1         51.9  48.1 100.0
2         45.2  54.8 100.0
3         49.6  50.4 100.0
8         71.8  28.2 100.0
9         27.2  72.8 100.0
Ensemble  49.2  50.8 100.0</code></pre>
</div>
</div>
</section>
<section id="résumer-une-variable-numérique" class="level2">
<h2 class="anchored" data-anchor-id="résumer-une-variable-numérique">Résumer une variable numérique</h2>
<p>Pour chaque calcul, ajouter l’option na.rm=TRUE car R ne calcule pas s’il y a des manquants (NA):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(FPA<span class="sc">$</span>ap_renc,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1955</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(FPA<span class="sc">$</span>ap_renc,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2010</code></pre>
</div>
</div>
<p>On peut le stocker dans un objet R comme valeur réutilisable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>anrencmin<span class="ot">&lt;-</span><span class="fu">min</span>(FPA<span class="sc">$</span>ap_renc,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calcul-dune-variable-numérique" class="level2">
<h2 class="anchored" data-anchor-id="calcul-dune-variable-numérique">Calcul d’une variable numérique</h2>
<p>On va calculer depuis combien d’année les personnes sont ensembles</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#annee d'enquete (2008) - annee de rencontre</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>FPA<span class="sc">$</span>durenc<span class="ot">=</span><span class="dv">2008</span><span class="sc">-</span>FPA<span class="sc">$</span>ap_renc</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on regarde la moyenne</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(FPA<span class="sc">$</span>durenc,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.20671</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou directement le résumé avec</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FPA<span class="sc">$</span>durenc)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  -2.00   10.00   18.00   19.21   27.00   53.00   10644 </code></pre>
</div>
</div>
</section>
<section id="graphiques" class="level2">
<h2 class="anchored" data-anchor-id="graphiques">Graphiques</h2>
<p>Rappel: on selectionne le type de graphique selon le type des variables.</p>
<p>Plus d’infos sur <a href="https://www.data-to-viz.com/" class="uri">https://www.data-to-viz.com/</a>)</p>
<p><a href="images/im_dataviz.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/im_dataviz.png" class="img-fluid"></a></p>
</section>
<section id="boite-à-moustaches" class="level2">
<h2 class="anchored" data-anchor-id="boite-à-moustaches">Boite à moustaches</h2>
<p>Pour décrire une variable numérique continue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(FPA<span class="sc">$</span>durenc)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="support-061124_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Ajout d’option titre, légende et couleur</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(FPA<span class="sc">$</span>durenc, <span class="at">main =</span> <span class="st">"Distribution de la durée de couple"</span>,<span class="at">ylab =</span> <span class="st">"Année"</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="support-061124_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Toutes les couleurs en anglais sont acceptées</p>
</section>
<section id="boite-à-moustaches-1" class="level2">
<h2 class="anchored" data-anchor-id="boite-à-moustaches-1">Boite à moustaches</h2>
<p>Pour représenter le croisement entre une variable qualitative et une variable quantitative :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(FPA<span class="sc">$</span>durenc<span class="sc">~</span>FPA<span class="sc">$</span>SEXEE,<span class="at">ylab=</span><span class="st">"Année"</span>,<span class="at">xlab=</span><span class="st">"Sexe"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="support-061124_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Cliquez sur Zoom pour voir tous les labels lorsque vous avez beaucoup de valeurs</p>
</section>
<section id="nuage-de-point" class="level2">
<h2 class="anchored" data-anchor-id="nuage-de-point">Nuage de point</h2>
<p>Pour représenter le croisement entre deux variables quantitatives</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exemple avec ce jeu de données du package questionr</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"hdv2003"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hdv2003<span class="sc">$</span>age,hdv2003<span class="sc">$</span>freres.soeurs)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="support-061124_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nuage-de-point-1" class="level2">
<h2 class="anchored" data-anchor-id="nuage-de-point-1">Nuage de point</h2>
<p>Pour voir les points en transparence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hdv2003<span class="sc">$</span>age, hdv2003<span class="sc">$</span>freres.soeurs, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="support-061124_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diagramme-en-baton" class="level2">
<h2 class="anchored" data-anchor-id="diagramme-en-baton">Diagramme en baton</h2>
<p>Pour représenter une variable qualitative</p>
<p>En vertical:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(FPA<span class="sc">$</span>D_DISCRI)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="support-061124_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>En horizontal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="at">height=</span><span class="fu">table</span>(FPA<span class="sc">$</span>D_DISCRI),<span class="at">horiz=</span><span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="support-061124_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diagramme-de-cleveland" class="level2">
<h2 class="anchored" data-anchor-id="diagramme-de-cleveland">Diagramme de Cleveland</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(<span class="fu">table</span>(FPA<span class="sc">$</span>regionnaise2_11t))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="support-061124_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="esquisse-faire-des-graphiques-sans-coder" class="level2">
<h2 class="anchored" data-anchor-id="esquisse-faire-des-graphiques-sans-coder">Esquisse: faire des graphiques sans coder</h2>
<p>Telecharger une seule fois le package:<br>
<code>install.packages("esquisse")</code></p>
<p>Cliquer sur le menu Addins: ggplot2 builder <img src="images/esquisse1.png" class="img-fluid"></p>
<p>Importer des données: soit dejà dans R: donc on selectionne “Environment” et on choisi la table R (ici FPA), Soit par un fichier exterieur (“External file”). On vérifie si les variables sont au bon format (numerique ou factor) dans l’onglet “Update”.<br>
Si c’est ok on clique sur “Import data”.</p>
<p>On arrive dans le menu avec toutes nos variables, selectionner dans X et Fill pour 2 variables qualitatives (en orange), ou X et Y pour 2 variables quantitatives (en bleu).</p>
</section>
<section id="esquisse" class="level2">
<h2 class="anchored" data-anchor-id="esquisse">Esquisse</h2>
<p><a href="images/esquisse2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/esquisse2.png" class="img-fluid"></a></p>
<p>On peut facilement changer les couleurs, le type de graphique et récupérer le code (ggplot2)</p>
</section>
<section id="manipulation-des-données-avec-r-de-base" class="level2" data-background-image="images/fond_logo1.png">
<h2 data-background-image="images/fond_logo1.png" class="anchored" data-anchor-id="manipulation-des-données-avec-r-de-base">Manipulation des données avec R de base</h2>
</section>
<section id="selection-de-variables-et-dobservation" class="level2">
<h2 class="anchored" data-anchor-id="selection-de-variables-et-dobservation">Selection de variables et d’observation</h2>
<p>Entre crochet on a la selection de ligne <strong>,</strong> selection de colonne</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>extrait<span class="ot">=</span>FPA[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>] </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nouvelle base <em>extrait</em> qui contient les 100 premières lignes et la 1ère à la 12ème variables (ou colonnes) de la base FPA.</p>
</section>
<section id="selection-de-variables-ou-colonnes" class="level2">
<h2 class="anchored" data-anchor-id="selection-de-variables-ou-colonnes">Selection de variables (ou colonnes)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>extrait<span class="ot">=</span>FPA[, <span class="dv">3</span><span class="sc">:</span><span class="dv">12</span>] </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ou on nomme les noms des variables</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>extrait2<span class="ot">=</span> FPA[, <span class="fu">c</span>(<span class="st">"GROUP1"</span>, <span class="st">"SEXEE"</span>, <span class="st">"D_DISCRI"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ou supprimer des variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>extrait2<span class="ot">=</span>FPA[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)] </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selection-dobservations-ou-de-lignes" class="level2">
<h2 class="anchored" data-anchor-id="selection-dobservations-ou-de-lignes">Selection d’observations (ou de lignes)</h2>
<p>ex : Selection de tous les hommes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dh <span class="ot">&lt;-</span> FPA[FPA<span class="sc">$</span>SEXEE <span class="sc">==</span> <span class="st">"1"</span>, ]   </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Selection de toutes les lignes sauf les hommes (donc selection des femmes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> FPA[FPA<span class="sc">$</span>SEXEE <span class="sc">!=</span> <span class="st">"1"</span>, ]  </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous verrons qu’avec le package dplyr, la selection de variable ou d’observation et tout autre manipulation sur les données sera facilitées.</p>
</section>
<section id="convertir-des-données" class="level2">
<h2 class="anchored" data-anchor-id="convertir-des-données">Convertir des données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#De numérique ou caractère à facteur </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>FPA<span class="sc">$</span>ap_rencfac <span class="ot">&lt;-</span> <span class="fu">factor</span>(FPA<span class="sc">$</span>ap_renc)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#De facteur ou numérique en caractère:</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>FPA<span class="sc">$</span>regionnaisc <span class="ot">&lt;-</span> <span class="fu">as.character</span>(FPA<span class="sc">$</span>regionnaise2_11t)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Convertir en numérique</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(FPA<span class="sc">$</span>T_DIPLOM))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recodage-et-création-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="recodage-et-création-de-variables">Recodage et création de variables</h2>
<p>La commande levels donne les résultats suivants :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(FPA<span class="sc">$</span>D_DISCRI)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2" "3" "8" "9"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On recode </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(FPA<span class="sc">$</span>D_DISCRI)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Souvent"</span> ,<span class="st">"Parfois"</span> , <span class="st">"Jamais"</span>,<span class="st">"Refuse de répondre"</span>,<span class="st">"Ne sait pas"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(FPA<span class="sc">$</span>D_DISCRI)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Souvent"            "Parfois"            "Jamais"            
[4] "Refuse de répondre" "Ne sait pas"       </code></pre>
</div>
</div>
</section>
<section id="recodage-et-création-de-variables-1" class="level2">
<h2 class="anchored" data-anchor-id="recodage-et-création-de-variables-1">Recodage et création de variables</h2>
<p>En clic bouton vous pouvez utiliser iorder, icut et irec (du package questionr) et récupérer le code:</p>
<ul>
<li><p>pour réordonner des valeur: <code>iorder(FPA$D_DISCRI)</code></p></li>
<li><p>pour classer des variables numériques (ex: classe d’âge): <code>icut(hdv2003)</code></p></li>
<li><p>pour créer et recoder plus facilement: <code>irec(FPA$D_DISCRI)</code><br>
<img src="images/irec1.png" class="img-fluid"> N’oubliez pas de faire executer le code généré.</p></li>
</ul>
</section>
<section id="organiser-et-traiter-plus-facilement-ses-données-avec-le-package-dplyr" class="level2" data-background-image="images/fond_logo1.png">
<h2 data-background-image="images/fond_logo1.png" class="anchored" data-anchor-id="organiser-et-traiter-plus-facilement-ses-données-avec-le-package-dplyr">Organiser et traiter plus facilement ses données avec le package dplyr</h2>
</section>
<section id="package-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="package-dplyr">Package dplyr</h2>
<p>Package développé par Hadley Wickham,(R Studio) qui a aussi développé ggplot2 et fait partie du <strong>tidyverse</strong> (ensemble de packages qui fonctionne ensemble). Utilisation d’une grammaire {dplyr}, composée essentiellement de 5 verbes qui vont indiquer des opérations courantes sur les lignes et les colonnes d’une structure de données.</p>
<p>Installer et activer le package avant de commencer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ou installer tidyverse qui contient tous les packages utiles par la suite</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="les-5-verbes-ou-fonction-de-base-de-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="les-5-verbes-ou-fonction-de-base-de-dplyr">Les 5 verbes (ou fonction) de base de dplyr</h2>
<p>Se poser les questions:<br>
- Sur quel data frame je travaille ?<br>
- Que dois je faire avec ?</p>
<ul>
<li><p>select(): Sélection de colonnes (variables)</p></li>
<li><p>filter(): Sélection de lignes (observations)</p></li>
<li><p>arrange(): Ordonne les lignes du dataframe (ou table)</p></li>
<li><p>mutate(): Ajout de colonnes (création de variables)</p></li>
<li><p>summarise(): Production de statistiques résumées</p></li>
</ul>
</section>
<section id="select-sélection-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="select-sélection-de-variables">Select: Sélection de variables</h2>
<p><code>select()</code> permet de définir une liste de variables à sélectionner dans le data frame résultant.<br>
Syntaxe : select(dataframe,liste_de_variables)<br>
Liste de variables séparées par des “,” ou :</p>
<p>Facilités d’écriture pour éviter d’écrire de nombreuses variables:<br>
<code>starts_with()</code>: commence par<br>
<code>ends_with()</code> : fini par<br>
<code>contains()</code> : contient<br>
<code>one_of()</code> : contient un ensemble d’éléments<br>
<code>everything()</code>: toutes les variables</p>
<p>Exemples :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,D_DISCRI,SEXEE,regionnaise2_11t,GROUP1) <span class="co"># ouvrir la table a pour voir le résultat à chaque fois</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,GROUP1<span class="sc">:</span>D_DISCRI) <span class="co"># on selectionne les variables GROUP1 à D_DISCRI</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,GROUP1,<span class="fu">starts_with</span>(<span class="st">"D_"</span>)) <span class="co"># on selectionne les variables GROUP1 et toutes celles commençant par "D_" (variables de discrimminations)</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,<span class="fu">contains</span>(<span class="st">"GROUP"</span>)) <span class="co"># on selectionne les variables qui contiennent le mot "GROUP" dans le nom de la variable  </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Supprimer des variables avec -  </span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"C_"</span>)) <span class="co"># on supprime les variables qui commencent par "C_"</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">"_E"</span>)) <span class="co"># on supprime les variables qui finissent par "_E"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA,<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"_"</span>)) <span class="co"># on supprime les variable qui contiennent un _ (trait souligné)</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">select</span>(FPA, <span class="sc">-</span>GROUP1CA, <span class="sc">-</span>nbunions_t) <span class="co"># on supprime les variables GROUP1CA et nbunions_t</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-sélection-dobservations" class="level2">
<h2 class="anchored" data-anchor-id="filter-sélection-dobservations">Filter: Sélection d’observations</h2>
<p><code>filter()</code> permet de définir une liste d’observations sélectionnées en regard de conditions</p>
<p>Exemples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span> <span class="fu">filter</span>(FPA,GROUP1<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span> <span class="fu">filter</span>(FPA, GROUP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> D_DISCRI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Souvent"</span>,<span class="st">"Parfois"</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span> <span class="fu">filter</span>(FPA,<span class="fu">is.na</span>(F_DIP)) <span class="co"># selection des manquants</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On utlise <code>%in%</code> lorsqu’on selectionne plusieurs valeurs, si on en selectionne une seule valeur c’est <code>==</code>.</p>
<p><strong>Selection des valeurs qui contiennent tel mot (equivalent <code>contains</code>) avec grepl</strong><br>
ex: selection des valeurs qui contiennent le mot Etudiant</p>
<p><code>test=filter(FPA, grepl('Couple',TYPM5_MEN))</code></p>
</section>
<section id="arrange-trier-les-observations" class="level2">
<h2 class="anchored" data-anchor-id="arrange-trier-les-observations">Arrange: Trier les observations</h2>
<p><code>arrange()</code> permet de réordonner les observations en fonction de clés de tris. Une option desc permet de trier par valeurs décroissantes. Il est possible d’indiquer plusieurs clés d’ordonnancement.</p>
<p>Exemples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># croissant:</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">arrange</span>(FPA,SEXEE,D_DISCRI)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># decroissant:</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">arrange</span>(FPA,<span class="fu">desc</span>(SEXEE))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutate-création-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="mutate-création-de-variables">Mutate: Création de variables</h2>
<p><code>mutate()</code> permet de créer une variable en fonction de variables existantes.</p>
<p>Exemples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ifelse pour creer une variable avec 2 valeurs (equivalent de =SI() dans Excel)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">mutate</span>(FPA,<span class="at">discri=</span><span class="fu">ifelse</span>(D_DISCRI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>),<span class="st">"1"</span>,<span class="st">"0"</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#case_when() pour des conditions avec plusieurs modalités</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">=</span><span class="fu">mutate</span>(FPA_v2,<span class="at">group2=</span><span class="fu">case_when</span>(</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  GROUP1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>) <span class="sc">~</span> <span class="st">"Immigrés (ou natif DOM)"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  GROUP1 <span class="sc">==</span> <span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Groupe majoritaire"</span>, </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  GROUP1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"4"</span>) <span class="sc">&amp;</span> (regionnaism2_11t <span class="sc">==</span><span class="st">"France métro"</span> <span class="sc">|</span> regionnaisp2_11t <span class="sc">==</span><span class="st">"France métro"</span>)  <span class="sc">~</span> <span class="st">"Descendant d'un immigré"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  GROUP1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"4"</span>) <span class="sc">&amp;</span> (regionnaism2_11t <span class="sc">!=</span><span class="st">"France métro"</span> <span class="sc">&amp;</span> regionnaisp2_11t <span class="sc">!=</span><span class="st">"France métro"</span>)  <span class="sc">~</span> <span class="st">"Descendant 2 immigrés"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  GROUP1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"4"</span>) <span class="sc">&amp;</span> (<span class="fu">is.na</span>(regionnaism2_11t) <span class="sc">|</span> <span class="fu">is.na</span>(regionnaisp2_11t))  <span class="sc">~</span> <span class="st">"Descendant 2 immigrés"</span>))</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">#l'ordre de ces conditions est important : Il faut aller du plus spécifique au plus général. </span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">#verifier</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(FPA_v2<span class="sc">$</span>discri,FPA_v2<span class="sc">$</span>D_DISCRI)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    Souvent Parfois Jamais Refuse de répondre Ne sait pas
  0    1028    3849  16784                  7          93</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(FPA_v2<span class="sc">$</span>group2,FPA_v2<span class="sc">$</span>GROUP1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         
                             1    2    3    4    5
  Descendant 2 immigrés      0    0 5090  346    0
  Descendant d'un immigré    0    0 3071  305    0
  Groupe majoritaire         0    0    0    0 3781
  Immigrés (ou natif DOM) 8456  712    0    0    0</code></pre>
</div>
</div>
</section>
<section id="chainage-des-opérations-avec-le-pipe" class="level2">
<h2 class="anchored" data-anchor-id="chainage-des-opérations-avec-le-pipe">Chainage des opérations avec le “pipe” %&gt;%</h2>
<p>Une fois qu’on connait ces premiers élements l’interêt est de pouvoir les combiner.</p>
<p>Par exemple :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#peu lisible</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>FPA_v2<span class="ot">&lt;-</span><span class="fu">arrange</span>(<span class="fu">select</span>(<span class="fu">filter</span>(FPA, SEXEE <span class="sc">==</span> <span class="st">"2"</span>),SEXEE, <span class="fu">starts_with</span>(<span class="st">"D_"</span>)))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ou remettre à chaque fois le nom de la table</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(FPA,  SEXEE <span class="sc">==</span> <span class="st">"2"</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">select</span>(tmp,SEXEE, D_DISCRI, D_PQDISC_A, D_PQDISC_B)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(tmp, D_DISCRI)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,480 × 4
   SEXEE D_DISCRI D_PQDISC_A D_PQDISC_B
   &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;      &lt;fct&gt;     
 1 2     Souvent  0          0         
 2 2     Souvent  0          1         
 3 2     Souvent  0          0         
 4 2     Souvent  0          0         
 5 2     Souvent  0          0         
 6 2     Souvent  1          1         
 7 2     Souvent  0          0         
 8 2     Souvent  1          0         
 9 2     Souvent  1          0         
10 2     Souvent  0          0         
# ℹ 11,470 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Avec dplyr et le %\&gt;% on obtient:</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>hdvf<span class="ot">&lt;-</span> FPA <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SEXEE <span class="sc">==</span> <span class="st">"2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEXEE, <span class="fu">starts_with</span>(<span class="st">"D_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(D_DISCRI)  </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre exemple:</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>FPA_v2 <span class="ot">&lt;-</span> FPA <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GROUP1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discri=</span><span class="fu">ifelse</span>(D_DISCRI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>),<span class="st">"1"</span>,<span class="st">"0"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-fonction-group_by" class="level2">
<h2 class="anchored" data-anchor-id="la-fonction-group_by">La fonction group_by</h2>
<p>La fonction group_by s’utilise avec les %&gt;% et permet de définir des groupes de lignes à partir des valeurs d’une ou plusieurs colonnes</p>
<p>Exemples :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creation de variable avec group by:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>FPA_v3 <span class="ot">&lt;-</span> FPA <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEXEE) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moyrenc =</span> <span class="fu">mean</span>(durenc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEXEE,GROUP1,durenc,moyrenc)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># group_by peut aussi être utile avec filter :</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>FPA_v3 <span class="ot">&lt;-</span> FPA <span class="sc">%&gt;%</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEXEE) <span class="sc">%&gt;%</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(durenc <span class="sc">==</span> <span class="fu">max</span>(durenc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-fonction-summarise" class="level2">
<h2 class="anchored" data-anchor-id="la-fonction-summarise">La fonction summarise</h2>
<p><code>summarise()</code> permet de produire des statistiques à un niveau agrégé. Il faut indiquer le(s) critère(s) d’agrégation et la (les) statistique(s) à calculer.</p>
<ul>
<li><p>Une instruction group_by est indispensable pour specifier en amont les critères d’agregation</p></li>
<li><p>Quelques exemples de fonctions : count, mean, sum, max</p></li>
<li><p>Il est possible de préciser des conditions dans les calculs (exemple sum(x&gt;10))</p></li>
</ul>
</section>
<section id="la-fonction-summarise-1" class="level2">
<h2 class="anchored" data-anchor-id="la-fonction-summarise-1">La fonction summarise</h2>
<p>Le résultat peut être stocké au niveau individuel (mutate) ou agrégé (summarise)</p>
<p>Une option na.rm=T permet d’éliminer les observations pour lesquelles figure une valeur manquante.</p>
<p>Une instruction ungroup() peut être necessaire pour réinitaliser le calcul de variables individuelles.<br>
Exemple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>FPA <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">minanneer =</span> <span class="fu">min</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxanneer =</span> <span class="fu">max</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  minanneer maxanneer
      &lt;dbl&gt;     &lt;dbl&gt;
1      1955      2010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># avec group by</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>FPA <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEXEE) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">minanneer =</span> <span class="fu">min</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxanneer =</span> <span class="fu">max</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbpers =</span> <span class="fu">n</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  SEXEE minanneer maxanneer Nbpers
  &lt;fct&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;
1 1          1960      2009  10281
2 2          1955      2010  11480</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le resultat peut aussi etre stocké à un niveau individuel </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>result<span class="ot">=</span>FPA <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEXEE) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">minanneer =</span> <span class="fu">min</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxanneer =</span> <span class="fu">max</span>(ap_renc, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Nbpers =</span> <span class="fu">n</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculer-un-rang" class="level2">
<h2 class="anchored" data-anchor-id="calculer-un-rang">Calculer un rang</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>FPA <span class="ot">=</span> FPA <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  group_by(SEXEE) %&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rang=</span><span class="fu">row_number</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reproduire-les-résultats-du-popsoc" class="level2">
<h2 class="anchored" data-anchor-id="reproduire-les-résultats-du-popsoc">Reproduire les résultats du Pop&amp;soc</h2>
<p><a href="images/graph1teo.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="images/graph1teo.PNG" class="img-fluid"></a></p>
</section>
<section id="reproduire-les-résultats-du-popsoc-1" class="level2">
<h2 class="anchored" data-anchor-id="reproduire-les-résultats-du-popsoc-1">Reproduire les résultats du Pop&amp;soc</h2>
<p><a href="images/graph2teo.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="images/graph2teo.PNG" class="img-fluid"></a></p>
</section>
<section id="les-jointures-et-empilements" class="level2">
<h2 class="anchored" data-anchor-id="les-jointures-et-empilements">Les jointures et empilements</h2>
<p>Syntaxe générale:<br>
<code>Type_de_jointure(dataframes, by="cle")</code><br>
Les clés de jointure peuvent être de noms différents.</p>
<p>Plusieurs types de jointure dans dplyr (équivalent du code sql):<br>
<strong>Inner join</strong>: Selection des observations communes entre les 2 tables. <img src="images/innerjoin.png" class="img-fluid"></p>
<p>Exemple: <code>teo3 = inner_join(teo1,teo2,by="id")</code></p>
</section>
<section id="les-jointures" class="level2">
<h2 class="anchored" data-anchor-id="les-jointures">Les jointures</h2>
<ul>
<li><p><strong>Full join</strong>: Selection de toutes les observations <img src="images/fulljoin.png" class="img-fluid"> Exemple si l’identifiant n’a pas le même nom:&nbsp;<code>teo3=full_join(teo1,teo2, by = c("id" = "id2"))</code></p></li>
<li><p><strong>Left join</strong>: Selection des observations présentes dans la première table <img src="images/leftjoin.png" class="img-fluid"></p></li>
<li><p><strong>Right join</strong>: Selection des observations présentes dans la deuxième table <img src="images/rightjoin.png" class="img-fluid"></p></li>
</ul>
<p>Une “cheat sheet” de R Studio sur les jointures résume bien ce que ça fait: <img src="images/jointure.png" class="img-fluid"></p>
</section>
<section id="les-jointures-1" class="level2">
<h2 class="anchored" data-anchor-id="les-jointures-1">Les jointures</h2>
<ul>
<li><strong>Semi join</strong>: garde que les lignes et colonnes de table1 presente aussi dans table2</li>
<li><strong>Anti join</strong>: garde que les lignes et colonnes dans table1 et pas dans table2</li>
</ul>
</section>
<section id="les-jointures-2" class="level2">
<h2 class="anchored" data-anchor-id="les-jointures-2">Les jointures</h2>
<p>Il faut que les variables soient communes entre les 2 tables jointes pour utiliser les fonctions ci-dessous (pas besoin de clé de jointure): <img src="images/jointure2.png" class="img-fluid"></p>
</section>
<section id="les-empilements" class="level2">
<h2 class="anchored" data-anchor-id="les-empilements">Les empilements</h2>
<p>Lorsque les variables sont les memes entre 2 tables et que les individus sont différents :</p>
<p><strong>bind_rows()</strong></p>
<p>Exemple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>teo_fin <span class="ot">=</span> <span class="fu">bind_rows</span>(teo1,teo2)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pour voir de quel table viennent les lignes: .id</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>teo_fin<span class="ot">=</span><span class="fu">bind_rows</span>(teo1,teo2, <span class="at">.id =</span> <span class="st">"source"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="limites-des-jointures" class="level2">
<h2 class="anchored" data-anchor-id="limites-des-jointures">Limites des jointures</h2>
<ul>
<li><p>Variables de même nom conservées dans le dataframe de sortie (avec suffixe .x et .y par défaut)</p></li>
<li><p>Pas de possibilité de lier directement 3 dataframes via dplyr</p></li>
</ul>
</section>
<section id="transformation-des-données" class="level2">
<h2 class="anchored" data-anchor-id="transformation-des-données">Transformation des données</h2>
<p>Tidy datas : Par définition, une donnée est représentée par une valeur sur une ligne (observation) pour une mesure (variable). Sinon, il faut transformer les données.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="images/widetolong.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="images/widetolong.png" class="img-fluid"></a></p>
<p>C’est notamment très utilisé si on souhaite passer d’une base individus à une base ménage ou inversement.</p>
</section>
<section id="pivot_wider-de-long-en-large" class="level2">
<h2 class="anchored" data-anchor-id="pivot_wider-de-long-en-large">Pivot_wider : de long en large</h2>
<p>Permet de restructurer un dataframe par information (1 ligne = 1 information, et non un individu)</p>
<p>Ici nous allons voir comment passer d’une observation niveau logement à une observation niveau individu ?</p>
<p>Avec le code de base puis en améliorant le code au fur et à mesure</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fichier en entree </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>LOG<span class="ot">=</span><span class="fu">read.csv2</span>(<span class="st">"./materiel/LOG.csv"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># code de base: pivot_wider</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>IND<span class="ot">=</span> LOG <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Age, <span class="at">values_from =</span> SO_LOG)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># on retire la variable dep_log pour obtenir un seul individu par ligne</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>IND <span class="ot">=</span> LOG <span class="sc">%&gt;%</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DEPT_LOG) <span class="sc">%&gt;%</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Age, <span class="at">values_from =</span> SO_LOG)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co"># on ajoute le suffixe age comme nom de variable</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>IND <span class="ot">=</span> LOG <span class="sc">%&gt;%</span> </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DEPT_LOG) <span class="sc">%&gt;%</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age=</span><span class="fu">paste0</span>(<span class="st">"Age"</span>,Age)) <span class="sc">%&gt;%</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Age, <span class="at">values_from =</span> SO_LOG)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># On garde uniquement les changements de STATUT </span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>IND2 <span class="ot">=</span> LOG <span class="sc">%&gt;%</span> </span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(IDENT,Age) <span class="sc">%&gt;%</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(IDENT) <span class="sc">%&gt;%</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SO_LOG<span class="sc">!=</span><span class="fu">lag</span>(SO_LOG) <span class="sc">|</span> <span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rang=</span><span class="fu">paste0</span>(<span class="st">"STA_"</span>,<span class="fu">row_number</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DEPT_LOG,<span class="sc">-</span>Age) <span class="sc">%&gt;%</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Rang, <span class="at">values_from =</span> SO_LOG)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="co"># resultat</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(IND2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   IDENT [6]
  IDENT STA_1   STA_2             STA_3        STA_4           STA_5
  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;
1   101 Parents "Propri�taire"    &lt;NA&gt;         &lt;NA&gt;            &lt;NA&gt; 
2   102 Parents "Locataire priv�" Propri�taire &lt;NA&gt;            &lt;NA&gt; 
3   103 Parents "Autre"           Propri�taire &lt;NA&gt;            &lt;NA&gt; 
4   104 Parents ""                HLM          Propri�taire    &lt;NA&gt; 
5   105 Parents ""                Parents      Locataire priv� &lt;NA&gt; 
6   106 Parents "HLM"             Propri�taire &lt;NA&gt;            &lt;NA&gt; </code></pre>
</div>
</div>
</section>
<section id="pivot_longer-de-large-en-long" class="level2">
<h2 class="anchored" data-anchor-id="pivot_longer-de-large-en-long">Pivot_longer : de large en long</h2>
<p>Exemple : Comment passer d’une observation niveau individu (vecteur de positions résidentielles) à une observation niveau logement ?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>LOG2 <span class="ot">=</span> IND <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"Age"</span>), <span class="at">names_to =</span> <span class="st">"Age"</span>, <span class="at">values_to =</span> <span class="st">"SO_LOG"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (SO_LOG <span class="sc">!=</span> <span class="fu">is.na</span>(SO_LOG)) <span class="sc">%&gt;%</span> <span class="co"># on retire si c'est manquant</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(IDENT)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#On revient au fichier d'origine</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Autre exemple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Pop <span class="ot">=</span> <span class="fu">data.frame</span>( <span class="at">Pays=</span><span class="fu">c</span>(<span class="st">"Danemark"</span>,<span class="st">"Finlande"</span>,<span class="st">"Norvege"</span>,<span class="st">"Suede"</span>),</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Pop1980=</span><span class="fu">c</span>(<span class="dv">5120</span>,<span class="dv">4771</span>,<span class="dv">4079</span>,<span class="dv">8303</span>),</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Pop1990=</span><span class="fu">c</span>(<span class="dv">5135</span>,<span class="dv">4974</span>,<span class="dv">4233</span>,<span class="dv">8527</span>),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Pop2000=</span><span class="fu">c</span>(<span class="dv">5330</span>,<span class="dv">5171</span>,<span class="dv">4478</span>,<span class="dv">8861</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Pop2010=</span><span class="fu">c</span>(<span class="dv">5535</span>,<span class="dv">5351</span>,<span class="dv">4855</span>,<span class="dv">9341</span>))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Pop)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>PopLong<span class="ot">=</span>Pop  <span class="sc">%&gt;%</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(Pop1980, Pop1990, Pop2000,Pop2010), <span class="at">names_to =</span> <span class="st">"Var"</span>, <span class="at">values_to =</span> <span class="st">"Valeur"</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># même chose avec stats_with pour ne pas écrire toutes les variables</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>PopLong<span class="ot">=</span>Pop  <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"Pop"</span>), <span class="at">names_to =</span> <span class="st">"Var"</span>, <span class="at">values_to =</span> <span class="st">"Valeur"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co"># La transformation de cette table nous permet maintenant de réaliser le graphique suivant:</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>PopLong <span class="sc">%&gt;%</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">annee=</span><span class="fu">as.numeric</span>(<span class="fu">substr</span>(Var,<span class="dv">4</span>,<span class="dv">7</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> annee, <span class="at">y =</span> Valeur, <span class="at">color =</span> Pays)) <span class="sc">+</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="support-061124_files/figure-html/unnamed-chunk-42-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="support-061124_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="traitements-massifs-et-opérations-sur-les-métadonnées" class="level2">
<h2 class="anchored" data-anchor-id="traitements-massifs-et-opérations-sur-les-métadonnées">Traitements massifs et opérations sur les métadonnées</h2>
<p>L’objectif est de pouvoir appliquer plusieurs fonctions à plusieurs variables.</p>
<p>A partir d’un fichier contenant des caractéristiques démographiques de communes d’Ile de France de 1954 à 1990, on cherche à déterminer quelles sont les populations minimales, moyennes et maximales des populations 1968 à 1990, par département ?<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intégration des données</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"./materiel/idf1.RData"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise_all  </span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> idf1 <span class="sc">%&gt;%</span>   </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(dep,<span class="fu">starts_with</span>(<span class="st">"pt"</span>),<span class="fu">starts_with</span>(<span class="st">"na"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dep) <span class="sc">%&gt;%</span>  </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">funs</span>(min,max,mean))  </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise_at  </span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> idf1 <span class="sc">%&gt;%</span>  </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dep) <span class="sc">%&gt;%</span>  </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">"pt"</span>)),<span class="fu">funs</span>(min,max,mean)) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="traitements-massifs-et-opérations-sur-les-métadonnées-1" class="level2">
<h2 class="anchored" data-anchor-id="traitements-massifs-et-opérations-sur-les-métadonnées-1">Traitements massifs et opérations sur les métadonnées</h2>
<p>Transformer toutes les variables de type facteur en variable de type caractère <code>h2 = FPA %&gt;% mutate_if(is.factor,as.character)</code></p>
<p>Renommer une série de variables:<br>
<code>rename_at</code></p>
<p>Recodification automatique:<br>
<code>mutate_at</code></p>
<p>Changement de type:<br>
<code>mutate_if</code></p>
</section>
<section id="sauvegarder-son-travail-et-recharger-ses-données" class="level2">
<h2 class="anchored" data-anchor-id="sauvegarder-son-travail-et-recharger-ses-données">Sauvegarder son travail et recharger ses données</h2>
<p>Les programmes R sont enregistrés avec l’extension .R, on peut l’ouvrir avec bloc note ou word.</p>
<ul>
<li><p>Sauvegarder son dataframe:<br>
<code>save(FPA_v2, file = "teo_fin.RData")</code></p></li>
<li><p>Sauvegarder son projet ou son environnement R Studio:<br>
<code>save.image("travail_teo.RData")</code></p></li>
<li><p>Recharger ses données R:<br>
<code>load("teo_fin.RData")</code></p></li>
</ul>
</section>
<section id="exporter-dans-un-fichier-excel" class="level2">
<h2 class="anchored" data-anchor-id="exporter-dans-un-fichier-excel">Exporter dans un fichier excel</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"writexl"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(FPA,<span class="st">"./materiel/teo.xlsx"</span>) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="références" class="level2">
<h2 class="anchored" data-anchor-id="références">Références</h2>
<ul>
<li><p>Rzine, pour la diffusion et le partage de ressources sur la pratique de R en Sciences Humaines et Sociales:<br>
<a href="https://rzine.fr/" class="uri">https://rzine.fr/</a></p></li>
<li><p>Tidyverse :<br>
<a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a></p></li>
<li><p>Documentation de Julien Barnier :<br>
<a href="https://juba.github.io/tidyverse/02-prise_en_main.html" class="uri">https://juba.github.io/tidyverse/02-prise_en_main.html</a></p></li>
<li><p>Documentation de Joseph Larmarange :<br>
<a href="http://larmarange.github.io/analyse-R/presentation-et-philosophie.html" class="uri">http://larmarange.github.io/analyse-R/presentation-et-philosophie.html</a></p></li>
</ul>
</section>
<section id="références-1" class="level2">
<h2 class="anchored" data-anchor-id="références-1">Références</h2>
<ul>
<li><p>Wickham, Hadley. «Tidy Data». Journal of Statistical Software; Vol 1, Issue 10 (2014) :<br>
<a href="https://www.jstatsoft.org/v059/i10" class="uri">https://www.jstatsoft.org/v059/i10</a></p></li>
<li><p>Cheat sheets :<br>
<a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p></li>
<li><p>Séminaire RUSS :<br>
<a href="https://russ.site.ined.fr/" class="uri">https://russ.site.ined.fr/</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a href="img1/logos.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="img1/logos.png" class="img-fluid"></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","loop":false,"closeEffect":"zoom","descPosition":"bottom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>